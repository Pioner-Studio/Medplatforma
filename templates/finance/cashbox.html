{% extends "_layout.html" %} {% block content %}
<h1 class="h1">Касса</h1>

<div class="grid" style="grid-template-columns: 240px 240px; gap: 16px">
  <div class="card">
    <div class="muted">Доходы</div>
    <div style="font-size: 28px; font-weight: 700">
      {{ income|default(0) }} ₽
    </div>
  </div>
  <div class="card">
    <div class="muted">Расходы</div>
    <div style="font-size: 28px; font-weight: 700">
      {{ expense|default(0) }} ₽
    </div>
  </div>
</div>

<div class="space"></div>

<div class="card">
  <div class="muted" style="margin-bottom: 8px">Поступления по источникам</div>
  <div class="toolbar">
    <span class="pill">Альфа — {{ by_source.alpha|default(0) }} ₽</span>
    <span class="pill">Сбер — {{ by_source.sber|default(0) }} ₽</span>
    <span class="pill">Нал — {{ by_source.cash|default(0) }} ₽</span>
  </div>

  <div class="muted" style="margin: 12px 0 8px">Расходы по категориям</div>
  <div class="toolbar" style="display: flex; gap: 8px; flex-wrap: wrap">
    {% set CAT_RU =
    {"purchase":"Закупка","marketing":"Маркетинг","dividends":"Дивиденды","rent":"Аренда"}
    %} {% if by_category %} {% for cat, sum in by_category.items() %}
    <a
      class="pill"
      href="/finance?type=expense&category={{ cat }}"
      title="Открыть операции категории «{{ CAT_RU.get(cat,cat) }}»"
    >
      {{ CAT_RU.get(cat,cat) }} — {{ sum }} ₽
    </a>
    {% endfor %} {% else %}
    <span class="muted">нет данных</span>
    {% endif %}
  </div>

  <div style="margin-top: 10px">
    <a class="link" href="/finance?type=expense">Все расходы</a>
  </div>

  <div class="space"></div>
  <div>
    <a class="link" href="/finance/export/csv?type=expense"
      >Экспорт расходов (CSV)</a
    >
    ·
    <a class="link" href="/finance/export/json?type=expense"
      >Экспорт расходов (JSON)</a
    >
  </div>

  <div class="space"></div>
  <div>
    Фильтр: <a class="link" href="/finance?source=alpha">Альфа</a> ·
    <a class="link" href="/finance?source=sber">Сбер</a> ·
    <a class="link" href="/finance?source=cash">Нал</a>
  </div>
</div>
{% endblock %}
