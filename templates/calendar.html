{% extends 'base.html' %}
{% block title %}Календарь{% endblock %}
{% block content %}

<div style="max-width:1400px; margin:0 auto; padding-top:32px;">
    <!-- Topbar: Заголовок + кнопка -->
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;">
        <h2 style="font-size:1.7rem; font-weight:700;">Календарь</h2>
        <a href="/add_event"
           style="background:#445be2;color:#fff;border:none;border-radius:10px;padding:12px 28px;
           font-weight:700;font-size:1.04rem;box-shadow:0 3px 12px rgba(60,80,160,0.10);
           text-decoration:none;transition:background 0.2s;">
            + Добавить запись
        </a>
    </div>

    <!-- FullCalendar -->
    <div id="calendar"
         style="min-height:700px; background:#fff; border-radius:22px; box-shadow:0 4px 40px rgba(60,60,120,0.07); padding:32px;">
    </div>
</div>

<!-- Подключение FullCalendar и инициализация -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/locales-all.global.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    var events = [
        // Тут можно подгружать события из Flask через Jinja2
        {% for event in events %}
        {
            title: "{{ event.title|e }}",
            start: "{{ event.datetime|e }}",
            end: "{{ event.end|default('')|e }}",
            // Можно добавить doctor, patient и другие поля для pop-up
        },
        {% endfor %}
    ];

    var calendar = new FullCalendar.Calendar(calendarEl, {
    locale: 'ru',
    initialView: 'timeGridDay',
    headerToolbar: {
        left: 'prev today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,timeGridDay'
    },
    buttonText: {
        today: 'Сегодня',
        month: 'Месяц',
        week: 'Неделя',
        day: 'День'
    },
    allDayText: 'Весь день',  // <-- перевод All day!
    events: events,
    height: 600,
    slotMinTime: "07:00:00",
    slotMaxTime: "22:00:00"
});
    calendar.render();
});
</script>

{% endblock %}
