    1: {% extends "base.html" %}
    2: {% block content %}
    3: <div class="xray-cabinet-wrap">
    4:     <div class="xray-header-row">
    5:         <h2>Р РµРЅС‚РіРµРЅ-РєР°Р±РёРЅРµС‚</h2>
    6:         <a href="{{ url_for('add_xray') }}" class="btn-main">
    7:             <i class="fa fa-plus"></i> Р”РѕР±Р°РІРёС‚СЊ СЃРЅРёРјРѕРє
    8:         </a>
    9:     </div>
   10:     <form method="get" class="xray-filters">
   11:         <select name="patient" class="filter-select">
   12:             <option value="">Р’СЃРµ РїР°С†РёРµРЅС‚С‹</option>
   13:             {% for p in patients.values() %}
   14:             <option value="{{ p['_id'] }}">{{ p['full_name'] }}</option>
   15:             {% endfor %}
   16:         </select>
   17:         <select name="doctor" class="filter-select">
   18:             <option value="">Р’СЃРµ РІСЂР°С‡Рё</option>
   19:             {% for d in doctors.values() %}
   20:             <option value="{{ d['_id'] }}">{{ d['full_name'] }}</option>
   21:             {% endfor %}
   22:         </select>
   23:         <select name="type" class="filter-select">
   24:             <option value="">Р’СЃРµ С‚РёРїС‹</option>
   25:             <option>РџР°РЅРѕСЂР°РјР°</option>
   26:             <option>РџСЂРёС†РµР»СЊРЅС‹Р№</option>
   27:             <option>РљРў</option>
   28:         </select>
   29:         <input type="date" name="date" class="filter-select">
   30:         <button type="submit" class="btn btn-secondary">Р¤РёР»СЊС‚СЂ</button>
   31:     </form>
   32: 
   33:     <div class="xray-table-zone">
   34:         <table class="xray-table">
   35:             <thead>
   36:                 <tr>
   37:                     <th>Р”Р°С‚Р°</th>
   38:                     <th>РџР°С†РёРµРЅС‚</th>
   39:                     <th>Р’СЂР°С‡</th>
   40:                     <th>РўРёРї</th>
   41:                     <th>РџСЂРµРІСЊСЋ</th>
   42:                     <th>Р—Р°РєР»СЋС‡РµРЅРёРµ</th>
   43:                     <th>Р”РµР№СЃС‚РІРёСЏ</th>
   44:                 </tr>
   45:             </thead>
   46:             <tbody>
   47:                 {% for x in xrays %}
   48:                 <tr>
   49:                     <td style="font-weight:600;font-size:1.09em;">{{ x.date }}</td>
   50:                     <td>
   51:                         <div class="xray-cell">
   52:                             <img src="{{ patients[x.patient_id]['avatar_url'] if x.patient_id in patients else '/static/avatars/demo-patient.png' }}" class="xray-avatar">
   53:                             <div>
   54:                                 <b>{{ patients[x.patient_id]['full_name'] if x.patient_id in patients else "вЂ”" }}</b>
   55:                                 <div class="xray-meta">{{ patients[x.patient_id]['phone'] if x.patient_id in patients else "" }}</div>
   56:                             </div>
   57:                         </div>
   58:                     </td>
   59:                     <td>
   60:                         <div class="xray-cell">
   61:                             <img src="{{ doctors[x.doctor_id]['avatar_url'] if x.doctor_id in doctors else '/static/avatars/demo-doctor.png' }}" class="xray-avatar">
   62:                             <div>
   63:                                 <b>{{ doctors[x.doctor_id]['full_name'] if x.doctor_id in doctors else "вЂ”" }}</b>
   64:                                 <div class="xray-meta">{{ doctors[x.doctor_id]['specialty'] if x.doctor_id in doctors else "" }}</div>
   65:                             </div>
   66:                         </div>
   67:                     </td>
   68:                     <td>
   69:                         <span class="xray-badge {{ x.type }}">{{ x.type }}</span>
   70:                     </td>
   71:                     <td>
   72:                         <img src="{{ x.image_url }}" class="xray-img-preview"
   73:                              onclick="showXrayModal('{{ x.image_url }}', '{{ x.comment|e }}', '{{ x.report|e }}')" alt="X-ray">
   74:                     </td>
   75:                     <td>
   76:                         <span>{{ x.comment or '-' }}</span>
   77:                     </td>
   78:                     <td>
   79:                         <a href="{{ x.image_url }}" download class="btn-download">
   80:                             <i class="fa fa-download"></i> РЎРєР°С‡Р°С‚СЊ
   81:                         </a>
   82:                     </td>
   83:                 </tr>
   84:                 {% endfor %}
   85:             </tbody>
   86:         </table>
   87:     </div>
   88: </div>
   89: 
   90: <!-- РњРѕРґР°Р»РєР° РґР»СЏ СѓРІРµР»РёС‡РµРЅРёСЏ СЃРЅРёРјРєР° -->
   91: <div class="modal" id="xrayModal" style="display:none;">
   92:     <div class="modal-content" style="max-width:670px;">
   93:         <span class="close" onclick="document.getElementById('xrayModal').style.display='none'">&times;</span>
   94:         <img id="modalXrayImg" src="" style="width:98%;border-radius:14px;box-shadow:0 4px 22px #8fc7fa44;margin-bottom:16px;">
   95:         <div id="modalComment" style="margin-bottom:8px;color:#2563eb;font-weight:500;"></div>
   96:         <div id="modalReport" style="font-size:1.13em;color:#222;"></div>
   97:     </div>
   98: </div>
   99: <script>
  100: function showXrayModal(url, comment, report) {
  101:     document.getElementById('modalXrayImg').src = url;
  102:     document.getElementById('modalComment').innerText = comment || '';
  103:     document.getElementById('modalReport').innerText = report || '';
  104:     document.getElementById('xrayModal').style.display = 'flex';
  105: }
  106: window.onclick = function(e) {
  107:     let modal = document.getElementById('xrayModal');
  108:     if (e.target === modal) modal.style.display = 'none';
  109: }
  110: </script>
  111: 
  112: {% block head %}
  113: <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  114: <style>
  115: .xray-cabinet-wrap { max-width: 1250px; margin: 0 auto; padding: 38px 0 36px 0; }
  116: .xray-header-row {
  117:     display: flex; align-items: center; justify-content: space-between; margin-bottom: 32px;
  118: }
  119: .xray-filters {
  120:     display: flex; gap: 14px; margin-bottom: 30px; flex-wrap: wrap; align-items: center;
  121: }
  122: .xray-table-zone {
  123:     background: #fff; border-radius: 20px; box-shadow: 0 4px 26px #e3eaf935;
  124:     padding: 22px 26px; margin-top: 0;
  125: }
  126: .xray-table { width: 100%; border-collapse: separate; border-spacing: 0; font-size: 1.07em; }
  127: .xray-table th, .xray-table td { padding: 15px 8px; vertical-align: middle; text-align: center; }
  128: .xray-table th { background: #f4f8ff; color: #145dbd; font-size: 1.04em; }
  129: .xray-table tbody tr { transition: background .13s; border-bottom: 1.5px solid #f1f4fa; }
  130: .xray-table tbody tr:hover { background: #f5fafd; }
  131: .xray-avatar { width: 38px; height: 38px; border-radius: 10px; object-fit: cover; margin-right: 8px; box-shadow:0 2px 8px #b9e4fa22; }
  132: .xray-cell { display: flex; align-items: center; gap: 8px; text-align: left; }
  133: .xray-meta { font-size: 0.98em; color: #8493b5; }
  134: .xray-badge { display: inline-block; padding: 6px 15px; border-radius: 8px; font-size: 0.97em; font-weight: 600; color: #fff; margin-bottom: 2px;}
  135: .xray-badge.РџР°РЅРѕСЂР°РјР° { background: #2196f3; }
  136: .xray-badge.РљРў { background: #21b445; }
  137: .xray-badge.РџСЂРёС†РµР»СЊРЅС‹Р№ { background: #ffa600; color: #222;}
  138: .xray-img-preview {
  139:     width: 62px; height: 62px; object-fit: cover; border-radius: 11px;
  140:     box-shadow: 0 2px 10px #a7d4fd33; transition: transform .17s, box-shadow .17s;
  141:     cursor: pointer;
  142:     border: 1.5px solid #e5ecf7;
  143: }
  144: .xray-img-preview:hover {
  145:     transform: scale(1.12) rotate(-2.5deg);
  146:     box-shadow: 0 6px 24px #2196f333;
  147: }
  148: .btn-main {
  149:     display:inline-flex;align-items:center;gap:9px;
  150:     background:linear-gradient(90deg,#2196f3 60%,#21b445 100%);
  151:     color:#fff;font-weight:700;border-radius:10px;
  152:     padding:12px 28px;font-size:1.08em;box-shadow:0 4px 16px #b5e3cb22;
  153:     border:none;text-decoration:none;transition:.14s;background-size:200%;
  154: }
  155: .btn-main:hover {background-position:right;color:#fff;}
  156: .btn-download {
  157:     display: inline-flex; align-items: center; gap: 7px;
  158:     padding: 7px 17px; font-size: 0.97em; font-weight: 600;
  159:     background: #e8f3ff; color: #2576c6; border-radius: 8px; border: none;
  160:     box-shadow: 0 2px 7px #e3eaf933; text-decoration: none;
  161:     transition: background .13s, color .13s;
  162: }
  163: .btn-download:hover { background: #d1eaff; color: #1859b3; }
  164: .modal { align-items: center; justify-content: center; }
  165: .modal-content { animation: xraypop .3s; }
  166: @keyframes xraypop {
  167:     from { opacity:0; transform: scale(0.94);}
  168:     to   { opacity:1; transform: scale(1);}
  169: }
  170: </style>
  171: {% endblock %}
  172: {% endblock %}
