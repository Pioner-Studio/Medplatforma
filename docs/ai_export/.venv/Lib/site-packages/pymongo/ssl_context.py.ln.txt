    1: # Copyright 2014-present MongoDB, Inc.
    2: #
    3: # Licensed under the Apache License, Version 2.0 (the "License"); you
    4: # may not use this file except in compliance with the License.  You
    5: # may obtain a copy of the License at
    6: #
    7: # http://www.apache.org/licenses/LICENSE-2.0
    8: #
    9: # Unless required by applicable law or agreed to in writing, software
   10: # distributed under the License is distributed on an "AS IS" BASIS,
   11: # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
   12: # implied.  See the License for the specific language governing
   13: # permissions and limitations under the License.
   14: 
   15: """A fake SSLContext implementation."""
   16: from __future__ import annotations
   17: 
   18: import ssl as _ssl
   19: 
   20: # PROTOCOL_TLS_CLIENT is Python 3.6+
   21: PROTOCOL_SSLv23 = getattr(_ssl, "PROTOCOL_TLS_CLIENT", _ssl.PROTOCOL_SSLv23)
   22: OP_NO_SSLv2 = getattr(_ssl, "OP_NO_SSLv2", 0)
   23: OP_NO_SSLv3 = getattr(_ssl, "OP_NO_SSLv3", 0)
   24: OP_NO_COMPRESSION = getattr(_ssl, "OP_NO_COMPRESSION", 0)
   25: # Python 3.7+, OpenSSL 1.1.0h+
   26: OP_NO_RENEGOTIATION = getattr(_ssl, "OP_NO_RENEGOTIATION", 0)
   27: 
   28: HAS_SNI = getattr(_ssl, "HAS_SNI", False)
   29: IS_PYOPENSSL = False
   30: 
   31: # Errors raised by SSL sockets when in non-blocking mode.
   32: BLOCKING_IO_ERRORS = (_ssl.SSLWantReadError, _ssl.SSLWantWriteError)
   33: 
   34: # Base Exception class
   35: SSLError = _ssl.SSLError
   36: 
   37: from ssl import SSLContext  # noqa: F401,E402
   38: 
   39: if hasattr(_ssl, "VERIFY_CRL_CHECK_LEAF"):
   40:     from ssl import VERIFY_CRL_CHECK_LEAF  # noqa: F401
