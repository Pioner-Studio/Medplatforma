    1: from __future__ import annotations
    2: 
    3: 
    4: def get_short_path_name(long_name):
    5:     """Gets the short path name of a given long path - http://stackoverflow.com/a/23598461/200291."""
    6:     import ctypes  # noqa: PLC0415
    7:     from ctypes import wintypes  # noqa: PLC0415
    8: 
    9:     GetShortPathNameW = ctypes.windll.kernel32.GetShortPathNameW  # noqa: N806
   10:     GetShortPathNameW.argtypes = [wintypes.LPCWSTR, wintypes.LPWSTR, wintypes.DWORD]
   11:     GetShortPathNameW.restype = wintypes.DWORD
   12:     output_buf_size = 0
   13:     while True:
   14:         output_buf = ctypes.create_unicode_buffer(output_buf_size)
   15:         needed = GetShortPathNameW(long_name, output_buf, output_buf_size)
   16:         if output_buf_size >= needed:
   17:             return output_buf.value
   18:         output_buf_size = needed
   19: 
   20: 
   21: __all__ = [
   22:     "get_short_path_name",
   23: ]
