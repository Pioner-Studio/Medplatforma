    1: from __future__ import annotations
    2: 
    3: from virtualenv.activation.via_template import ViaTemplateActivator
    4: 
    5: 
    6: class PowerShellActivator(ViaTemplateActivator):
    7:     def templates(self):
    8:         yield "activate.ps1"
    9: 
   10:     @staticmethod
   11:     def quote(string):
   12:         """
   13:         This should satisfy PowerShell quoting rules [1], unless the quoted
   14:         string is passed directly to Windows native commands [2].
   15: 
   16:         [1]: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_quoting_rules
   17:         [2]: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_parsing#passing-arguments-that-contain-quote-characters
   18:         """  # noqa: D205
   19:         string = string.replace("'", "''")
   20:         return f"'{string}'"
   21: 
   22: 
   23: __all__ = [
   24:     "PowerShellActivator",
   25: ]
