    1: from __future__ import annotations
    2: 
    3: import logging
    4: import os
    5: import sys
    6: import tempfile
    7: 
    8: _FS_CASE_SENSITIVE = None
    9: LOGGER = logging.getLogger(__name__)
   10: IS_WIN = sys.platform == "win32"
   11: 
   12: 
   13: def fs_is_case_sensitive():
   14:     """Check if the file system is case-sensitive."""
   15:     global _FS_CASE_SENSITIVE  # noqa: PLW0603
   16: 
   17:     if _FS_CASE_SENSITIVE is None:
   18:         with tempfile.NamedTemporaryFile(prefix="TmP") as tmp_file:
   19:             _FS_CASE_SENSITIVE = not os.path.exists(tmp_file.name.lower())
   20:             LOGGER.debug("filesystem is %scase-sensitive", "" if _FS_CASE_SENSITIVE else "not ")
   21:     return _FS_CASE_SENSITIVE
   22: 
   23: 
   24: def fs_path_id(path: str) -> str:
   25:     """Get a case-normalized path identifier."""
   26:     return path.casefold() if fs_is_case_sensitive() else path
   27: 
   28: 
   29: __all__ = (
   30:     "IS_WIN",
   31:     "fs_is_case_sensitive",
   32:     "fs_path_id",
   33: )
