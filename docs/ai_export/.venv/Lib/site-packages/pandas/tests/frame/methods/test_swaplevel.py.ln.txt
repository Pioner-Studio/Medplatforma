    1: import pytest
    2: 
    3: from pandas import DataFrame
    4: import pandas._testing as tm
    5: 
    6: 
    7: class TestSwaplevel:
    8:     def test_swaplevel(self, multiindex_dataframe_random_data):
    9:         frame = multiindex_dataframe_random_data
   10: 
   11:         swapped = frame["A"].swaplevel()
   12:         swapped2 = frame["A"].swaplevel(0)
   13:         swapped3 = frame["A"].swaplevel(0, 1)
   14:         swapped4 = frame["A"].swaplevel("first", "second")
   15:         assert not swapped.index.equals(frame.index)
   16:         tm.assert_series_equal(swapped, swapped2)
   17:         tm.assert_series_equal(swapped, swapped3)
   18:         tm.assert_series_equal(swapped, swapped4)
   19: 
   20:         back = swapped.swaplevel()
   21:         back2 = swapped.swaplevel(0)
   22:         back3 = swapped.swaplevel(0, 1)
   23:         back4 = swapped.swaplevel("second", "first")
   24:         assert back.index.equals(frame.index)
   25:         tm.assert_series_equal(back, back2)
   26:         tm.assert_series_equal(back, back3)
   27:         tm.assert_series_equal(back, back4)
   28: 
   29:         ft = frame.T
   30:         swapped = ft.swaplevel("first", "second", axis=1)
   31:         exp = frame.swaplevel("first", "second").T
   32:         tm.assert_frame_equal(swapped, exp)
   33: 
   34:         msg = "Can only swap levels on a hierarchical axis."
   35:         with pytest.raises(TypeError, match=msg):
   36:             DataFrame(range(3)).swaplevel()
