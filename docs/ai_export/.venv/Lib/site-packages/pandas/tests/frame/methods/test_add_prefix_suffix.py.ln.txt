    1: import pytest
    2: 
    3: from pandas import Index
    4: import pandas._testing as tm
    5: 
    6: 
    7: def test_add_prefix_suffix(float_frame):
    8:     with_prefix = float_frame.add_prefix("foo#")
    9:     expected = Index([f"foo#{c}" for c in float_frame.columns])
   10:     tm.assert_index_equal(with_prefix.columns, expected)
   11: 
   12:     with_suffix = float_frame.add_suffix("#foo")
   13:     expected = Index([f"{c}#foo" for c in float_frame.columns])
   14:     tm.assert_index_equal(with_suffix.columns, expected)
   15: 
   16:     with_pct_prefix = float_frame.add_prefix("%")
   17:     expected = Index([f"%{c}" for c in float_frame.columns])
   18:     tm.assert_index_equal(with_pct_prefix.columns, expected)
   19: 
   20:     with_pct_suffix = float_frame.add_suffix("%")
   21:     expected = Index([f"{c}%" for c in float_frame.columns])
   22:     tm.assert_index_equal(with_pct_suffix.columns, expected)
   23: 
   24: 
   25: def test_add_prefix_suffix_axis(float_frame):
   26:     # GH 47819
   27:     with_prefix = float_frame.add_prefix("foo#", axis=0)
   28:     expected = Index([f"foo#{c}" for c in float_frame.index])
   29:     tm.assert_index_equal(with_prefix.index, expected)
   30: 
   31:     with_prefix = float_frame.add_prefix("foo#", axis=1)
   32:     expected = Index([f"foo#{c}" for c in float_frame.columns])
   33:     tm.assert_index_equal(with_prefix.columns, expected)
   34: 
   35:     with_pct_suffix = float_frame.add_suffix("#foo", axis=0)
   36:     expected = Index([f"{c}#foo" for c in float_frame.index])
   37:     tm.assert_index_equal(with_pct_suffix.index, expected)
   38: 
   39:     with_pct_suffix = float_frame.add_suffix("#foo", axis=1)
   40:     expected = Index([f"{c}#foo" for c in float_frame.columns])
   41:     tm.assert_index_equal(with_pct_suffix.columns, expected)
   42: 
   43: 
   44: def test_add_prefix_suffix_invalid_axis(float_frame):
   45:     with pytest.raises(ValueError, match="No axis named 2 for object type DataFrame"):
   46:         float_frame.add_prefix("foo#", axis=2)
   47: 
   48:     with pytest.raises(ValueError, match="No axis named 2 for object type DataFrame"):
   49:         float_frame.add_suffix("foo#", axis=2)
