    1: import pytest
    2: 
    3: from pandas import (
    4:     DataFrame,
    5:     Series,
    6: )
    7: import pandas._testing as tm
    8: 
    9: 
   10: class TestPipe:
   11:     def test_pipe(self, frame_or_series):
   12:         obj = DataFrame({"A": [1, 2, 3]})
   13:         expected = DataFrame({"A": [1, 4, 9]})
   14:         if frame_or_series is Series:
   15:             obj = obj["A"]
   16:             expected = expected["A"]
   17: 
   18:         f = lambda x, y: x**y
   19:         result = obj.pipe(f, 2)
   20:         tm.assert_equal(result, expected)
   21: 
   22:     def test_pipe_tuple(self, frame_or_series):
   23:         obj = DataFrame({"A": [1, 2, 3]})
   24:         obj = tm.get_obj(obj, frame_or_series)
   25: 
   26:         f = lambda x, y: y
   27:         result = obj.pipe((f, "y"), 0)
   28:         tm.assert_equal(result, obj)
   29: 
   30:     def test_pipe_tuple_error(self, frame_or_series):
   31:         obj = DataFrame({"A": [1, 2, 3]})
   32:         obj = tm.get_obj(obj, frame_or_series)
   33: 
   34:         f = lambda x, y: y
   35: 
   36:         msg = "y is both the pipe target and a keyword argument"
   37: 
   38:         with pytest.raises(ValueError, match=msg):
   39:             obj.pipe((f, "y"), x=1, y=0)
