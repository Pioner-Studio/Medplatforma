    1: from datetime import timedelta
    2: 
    3: from pandas import (
    4:     Index,
    5:     Timestamp,
    6:     date_range,
    7:     isna,
    8: )
    9: 
   10: 
   11: class TestAsOf:
   12:     def test_asof_partial(self):
   13:         index = date_range("2010-01-01", periods=2, freq="ME")
   14:         expected = Timestamp("2010-02-28")
   15:         result = index.asof("2010-02")
   16:         assert result == expected
   17:         assert not isinstance(result, Index)
   18: 
   19:     def test_asof(self):
   20:         index = date_range("2020-01-01", periods=10)
   21: 
   22:         dt = index[0]
   23:         assert index.asof(dt) == dt
   24:         assert isna(index.asof(dt - timedelta(1)))
   25: 
   26:         dt = index[-1]
   27:         assert index.asof(dt + timedelta(1)) == dt
   28: 
   29:         dt = index[0].to_pydatetime()
   30:         assert isinstance(index.asof(dt), Timestamp)
