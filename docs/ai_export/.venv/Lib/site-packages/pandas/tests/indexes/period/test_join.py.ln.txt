    1: import numpy as np
    2: import pytest
    3: 
    4: from pandas._libs.tslibs import IncompatibleFrequency
    5: 
    6: from pandas import (
    7:     DataFrame,
    8:     Index,
    9:     PeriodIndex,
   10:     date_range,
   11:     period_range,
   12: )
   13: import pandas._testing as tm
   14: 
   15: 
   16: class TestJoin:
   17:     def test_join_outer_indexer(self):
   18:         pi = period_range("1/1/2000", "1/20/2000", freq="D")
   19: 
   20:         result = pi._outer_indexer(pi)
   21:         tm.assert_extension_array_equal(result[0], pi._values)
   22:         tm.assert_numpy_array_equal(result[1], np.arange(len(pi), dtype=np.intp))
   23:         tm.assert_numpy_array_equal(result[2], np.arange(len(pi), dtype=np.intp))
   24: 
   25:     def test_joins(self, join_type):
   26:         index = period_range("1/1/2000", "1/20/2000", freq="D")
   27: 
   28:         joined = index.join(index[:-5], how=join_type)
   29: 
   30:         assert isinstance(joined, PeriodIndex)
   31:         assert joined.freq == index.freq
   32: 
   33:     def test_join_self(self, join_type):
   34:         index = period_range("1/1/2000", "1/20/2000", freq="D")
   35: 
   36:         res = index.join(index, how=join_type)
   37:         assert index is res
   38: 
   39:     def test_join_does_not_recur(self):
   40:         df = DataFrame(
   41:             np.ones((3, 2)),
   42:             index=date_range("2020-01-01", periods=3),
   43:             columns=period_range("2020-01-01", periods=2),
   44:         )
   45:         ser = df.iloc[:2, 0]
   46: 
   47:         res = ser.index.join(df.columns, how="outer")
   48:         expected = Index(
   49:             [ser.index[0], ser.index[1], df.columns[0], df.columns[1]], object
   50:         )
   51:         tm.assert_index_equal(res, expected)
   52: 
   53:     def test_join_mismatched_freq_raises(self):
   54:         index = period_range("1/1/2000", "1/20/2000", freq="D")
   55:         index3 = period_range("1/1/2000", "1/20/2000", freq="2D")
   56:         msg = r".*Input has different freq=2D from Period\(freq=D\)"
   57:         with pytest.raises(IncompatibleFrequency, match=msg):
   58:             index.join(index3)
