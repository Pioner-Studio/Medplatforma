    1: """Tests for PeriodIndex behaving like a vectorized Period scalar"""
    2: 
    3: import pytest
    4: 
    5: from pandas import (
    6:     Timedelta,
    7:     date_range,
    8:     period_range,
    9: )
   10: import pandas._testing as tm
   11: 
   12: 
   13: class TestPeriodIndexOps:
   14:     def test_start_time(self):
   15:         # GH#17157
   16:         index = period_range(freq="M", start="2016-01-01", end="2016-05-31")
   17:         expected_index = date_range("2016-01-01", end="2016-05-31", freq="MS")
   18:         tm.assert_index_equal(index.start_time, expected_index)
   19: 
   20:     def test_end_time(self):
   21:         # GH#17157
   22:         index = period_range(freq="M", start="2016-01-01", end="2016-05-31")
   23:         expected_index = date_range("2016-01-01", end="2016-05-31", freq="ME")
   24:         expected_index += Timedelta(1, "D") - Timedelta(1, "ns")
   25:         tm.assert_index_equal(index.end_time, expected_index)
   26: 
   27:     @pytest.mark.filterwarnings(r"ignore:PeriodDtype\[B\] is deprecated:FutureWarning")
   28:     @pytest.mark.filterwarnings(
   29:         "ignore:Period with BDay freq is deprecated:FutureWarning"
   30:     )
   31:     def test_end_time_business_friday(self):
   32:         # GH#34449
   33:         pi = period_range("1990-01-05", freq="B", periods=1)
   34:         result = pi.end_time
   35: 
   36:         dti = date_range("1990-01-05", freq="D", periods=1)._with_freq(None)
   37:         expected = dti + Timedelta(days=1, nanoseconds=-1)
   38:         tm.assert_index_equal(result, expected)
