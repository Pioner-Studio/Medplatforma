    1: import numpy as np
    2: import pytest
    3: 
    4: from pandas import (
    5:     Period,
    6:     PeriodIndex,
    7:     period_range,
    8: )
    9: import pandas._testing as tm
   10: 
   11: 
   12: class TestPeriodRepresentation:
   13:     """
   14:     Wish to match NumPy units
   15:     """
   16: 
   17:     @pytest.mark.parametrize(
   18:         "freq, base_date",
   19:         [
   20:             ("W-THU", "1970-01-01"),
   21:             ("D", "1970-01-01"),
   22:             ("B", "1970-01-01"),
   23:             ("h", "1970-01-01"),
   24:             ("min", "1970-01-01"),
   25:             ("s", "1970-01-01"),
   26:             ("ms", "1970-01-01"),
   27:             ("us", "1970-01-01"),
   28:             ("ns", "1970-01-01"),
   29:             ("M", "1970-01"),
   30:             ("Y", 1970),
   31:         ],
   32:     )
   33:     @pytest.mark.filterwarnings(r"ignore:PeriodDtype\[B\] is deprecated:FutureWarning")
   34:     @pytest.mark.filterwarnings(
   35:         "ignore:Period with BDay freq is deprecated:FutureWarning"
   36:     )
   37:     def test_freq(self, freq, base_date):
   38:         rng = period_range(start=base_date, periods=10, freq=freq)
   39:         exp = np.arange(10, dtype=np.int64)
   40: 
   41:         tm.assert_numpy_array_equal(rng.asi8, exp)
   42: 
   43: 
   44: class TestPeriodIndexConversion:
   45:     def test_tolist(self):
   46:         index = period_range(freq="Y", start="1/1/2001", end="12/1/2009")
   47:         rs = index.tolist()
   48:         for x in rs:
   49:             assert isinstance(x, Period)
   50: 
   51:         recon = PeriodIndex(rs)
   52:         tm.assert_index_equal(index, recon)
