    1: import pytest
    2: 
    3: from pandas import (
    4:     IntervalIndex,
    5:     MultiIndex,
    6:     RangeIndex,
    7: )
    8: import pandas._testing as tm
    9: 
   10: 
   11: @pytest.fixture
   12: def range_index():
   13:     return RangeIndex(3, name="range_index")
   14: 
   15: 
   16: @pytest.fixture
   17: def interval_index():
   18:     return IntervalIndex.from_tuples(
   19:         [(0.0, 1.0), (1.0, 2.0), (1.5, 2.5)], name="interval_index"
   20:     )
   21: 
   22: 
   23: def test_join_overlapping_in_mi_to_same_intervalindex(range_index, interval_index):
   24:     #  GH-45661
   25:     multi_index = MultiIndex.from_product([interval_index, range_index])
   26:     result = multi_index.join(interval_index)
   27: 
   28:     tm.assert_index_equal(result, multi_index)
   29: 
   30: 
   31: def test_join_overlapping_to_multiindex_with_same_interval(range_index, interval_index):
   32:     #  GH-45661
   33:     multi_index = MultiIndex.from_product([interval_index, range_index])
   34:     result = interval_index.join(multi_index)
   35: 
   36:     tm.assert_index_equal(result, multi_index)
   37: 
   38: 
   39: def test_join_overlapping_interval_to_another_intervalindex(interval_index):
   40:     #  GH-45661
   41:     flipped_interval_index = interval_index[::-1]
   42:     result = interval_index.join(flipped_interval_index)
   43: 
   44:     tm.assert_index_equal(result, interval_index)
