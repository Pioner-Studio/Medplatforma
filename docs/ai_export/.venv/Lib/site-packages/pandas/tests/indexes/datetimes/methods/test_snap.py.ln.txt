    1: import pytest
    2: 
    3: from pandas import (
    4:     DatetimeIndex,
    5:     date_range,
    6: )
    7: import pandas._testing as tm
    8: 
    9: 
   10: @pytest.mark.parametrize("tz", [None, "Asia/Shanghai", "Europe/Berlin"])
   11: @pytest.mark.parametrize("name", [None, "my_dti"])
   12: @pytest.mark.parametrize("unit", ["ns", "us", "ms", "s"])
   13: def test_dti_snap(name, tz, unit):
   14:     dti = DatetimeIndex(
   15:         [
   16:             "1/1/2002",
   17:             "1/2/2002",
   18:             "1/3/2002",
   19:             "1/4/2002",
   20:             "1/5/2002",
   21:             "1/6/2002",
   22:             "1/7/2002",
   23:         ],
   24:         name=name,
   25:         tz=tz,
   26:         freq="D",
   27:     )
   28:     dti = dti.as_unit(unit)
   29: 
   30:     result = dti.snap(freq="W-MON")
   31:     expected = date_range("12/31/2001", "1/7/2002", name=name, tz=tz, freq="w-mon")
   32:     expected = expected.repeat([3, 4])
   33:     expected = expected.as_unit(unit)
   34:     tm.assert_index_equal(result, expected)
   35:     assert result.tz == expected.tz
   36:     assert result.freq is None
   37:     assert expected.freq is None
   38: 
   39:     result = dti.snap(freq="B")
   40: 
   41:     expected = date_range("1/1/2002", "1/7/2002", name=name, tz=tz, freq="b")
   42:     expected = expected.repeat([1, 1, 1, 2, 2])
   43:     expected = expected.as_unit(unit)
   44:     tm.assert_index_equal(result, expected)
   45:     assert result.tz == expected.tz
   46:     assert result.freq is None
   47:     assert expected.freq is None
