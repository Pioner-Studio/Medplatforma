    1: from pandas import MultiIndex
    2: 
    3: 
    4: class TestIsLexsorted:
    5:     def test_is_lexsorted(self):
    6:         levels = [[0, 1], [0, 1, 2]]
    7: 
    8:         index = MultiIndex(
    9:             levels=levels, codes=[[0, 0, 0, 1, 1, 1], [0, 1, 2, 0, 1, 2]]
   10:         )
   11:         assert index._is_lexsorted()
   12: 
   13:         index = MultiIndex(
   14:             levels=levels, codes=[[0, 0, 0, 1, 1, 1], [0, 1, 2, 0, 2, 1]]
   15:         )
   16:         assert not index._is_lexsorted()
   17: 
   18:         index = MultiIndex(
   19:             levels=levels, codes=[[0, 0, 1, 0, 1, 1], [0, 1, 0, 2, 2, 1]]
   20:         )
   21:         assert not index._is_lexsorted()
   22:         assert index._lexsort_depth == 0
   23: 
   24: 
   25: class TestLexsortDepth:
   26:     def test_lexsort_depth(self):
   27:         # Test that lexsort_depth return the correct sortorder
   28:         # when it was given to the MultiIndex const.
   29:         # GH#28518
   30: 
   31:         levels = [[0, 1], [0, 1, 2]]
   32: 
   33:         index = MultiIndex(
   34:             levels=levels, codes=[[0, 0, 0, 1, 1, 1], [0, 1, 2, 0, 1, 2]], sortorder=2
   35:         )
   36:         assert index._lexsort_depth == 2
   37: 
   38:         index = MultiIndex(
   39:             levels=levels, codes=[[0, 0, 0, 1, 1, 1], [0, 1, 2, 0, 2, 1]], sortorder=1
   40:         )
   41:         assert index._lexsort_depth == 1
   42: 
   43:         index = MultiIndex(
   44:             levels=levels, codes=[[0, 0, 1, 0, 1, 1], [0, 1, 0, 2, 2, 1]], sortorder=0
   45:         )
   46:         assert index._lexsort_depth == 0
