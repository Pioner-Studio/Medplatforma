    1: from pandas import (
    2:     DataFrame,
    3:     DatetimeIndex,
    4:     date_range,
    5: )
    6: import pandas._testing as tm
    7: 
    8: 
    9: def test_isocalendar_returns_correct_values_close_to_new_year_with_tz():
   10:     # GH#6538: Check that DatetimeIndex and its TimeStamp elements
   11:     # return the same weekofyear accessor close to new year w/ tz
   12:     dates = ["2013/12/29", "2013/12/30", "2013/12/31"]
   13:     dates = DatetimeIndex(dates, tz="Europe/Brussels")
   14:     result = dates.isocalendar()
   15:     expected_data_frame = DataFrame(
   16:         [[2013, 52, 7], [2014, 1, 1], [2014, 1, 2]],
   17:         columns=["year", "week", "day"],
   18:         index=dates,
   19:         dtype="UInt32",
   20:     )
   21:     tm.assert_frame_equal(result, expected_data_frame)
   22: 
   23: 
   24: def test_dti_timestamp_isocalendar_fields():
   25:     idx = date_range("2020-01-01", periods=10)
   26:     expected = tuple(idx.isocalendar().iloc[-1].to_list())
   27:     result = idx[-1].isocalendar()
   28:     assert result == expected
