    1: import pytest
    2: 
    3: import pandas as pd
    4: import pandas._testing as tm
    5: 
    6: 
    7: class TestDatetimeIndexFillNA:
    8:     @pytest.mark.parametrize("tz", ["US/Eastern", "Asia/Tokyo"])
    9:     def test_fillna_datetime64(self, tz):
   10:         # GH 11343
   11:         idx = pd.DatetimeIndex(["2011-01-01 09:00", pd.NaT, "2011-01-01 11:00"])
   12: 
   13:         exp = pd.DatetimeIndex(
   14:             ["2011-01-01 09:00", "2011-01-01 10:00", "2011-01-01 11:00"]
   15:         )
   16:         tm.assert_index_equal(idx.fillna(pd.Timestamp("2011-01-01 10:00")), exp)
   17: 
   18:         # tz mismatch
   19:         exp = pd.Index(
   20:             [
   21:                 pd.Timestamp("2011-01-01 09:00"),
   22:                 pd.Timestamp("2011-01-01 10:00", tz=tz),
   23:                 pd.Timestamp("2011-01-01 11:00"),
   24:             ],
   25:             dtype=object,
   26:         )
   27:         tm.assert_index_equal(idx.fillna(pd.Timestamp("2011-01-01 10:00", tz=tz)), exp)
   28: 
   29:         # object
   30:         exp = pd.Index(
   31:             [pd.Timestamp("2011-01-01 09:00"), "x", pd.Timestamp("2011-01-01 11:00")],
   32:             dtype=object,
   33:         )
   34:         tm.assert_index_equal(idx.fillna("x"), exp)
   35: 
   36:         idx = pd.DatetimeIndex(["2011-01-01 09:00", pd.NaT, "2011-01-01 11:00"], tz=tz)
   37: 
   38:         exp = pd.DatetimeIndex(
   39:             ["2011-01-01 09:00", "2011-01-01 10:00", "2011-01-01 11:00"], tz=tz
   40:         )
   41:         tm.assert_index_equal(idx.fillna(pd.Timestamp("2011-01-01 10:00", tz=tz)), exp)
   42: 
   43:         exp = pd.Index(
   44:             [
   45:                 pd.Timestamp("2011-01-01 09:00", tz=tz),
   46:                 pd.Timestamp("2011-01-01 10:00"),
   47:                 pd.Timestamp("2011-01-01 11:00", tz=tz),
   48:             ],
   49:             dtype=object,
   50:         )
   51:         tm.assert_index_equal(idx.fillna(pd.Timestamp("2011-01-01 10:00")), exp)
   52: 
   53:         # object
   54:         exp = pd.Index(
   55:             [
   56:                 pd.Timestamp("2011-01-01 09:00", tz=tz),
   57:                 "x",
   58:                 pd.Timestamp("2011-01-01 11:00", tz=tz),
   59:             ],
   60:             dtype=object,
   61:         )
   62:         tm.assert_index_equal(idx.fillna("x"), exp)
