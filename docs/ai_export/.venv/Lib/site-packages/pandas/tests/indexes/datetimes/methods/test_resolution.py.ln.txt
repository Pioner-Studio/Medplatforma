    1: from dateutil.tz import tzlocal
    2: import pytest
    3: 
    4: from pandas.compat import IS64
    5: 
    6: from pandas import date_range
    7: 
    8: 
    9: @pytest.mark.parametrize(
   10:     "freq,expected",
   11:     [
   12:         ("YE", "day"),
   13:         ("QE", "day"),
   14:         ("ME", "day"),
   15:         ("D", "day"),
   16:         ("h", "hour"),
   17:         ("min", "minute"),
   18:         ("s", "second"),
   19:         ("ms", "millisecond"),
   20:         ("us", "microsecond"),
   21:     ],
   22: )
   23: def test_dti_resolution(request, tz_naive_fixture, freq, expected):
   24:     tz = tz_naive_fixture
   25:     if freq == "YE" and not IS64 and isinstance(tz, tzlocal):
   26:         request.applymarker(
   27:             pytest.mark.xfail(reason="OverflowError inside tzlocal past 2038")
   28:         )
   29: 
   30:     idx = date_range(start="2013-04-01", periods=30, freq=freq, tz=tz)
   31:     assert idx.resolution == expected
