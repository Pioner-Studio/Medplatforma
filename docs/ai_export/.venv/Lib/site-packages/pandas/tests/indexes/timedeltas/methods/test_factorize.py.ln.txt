    1: import numpy as np
    2: 
    3: from pandas import (
    4:     TimedeltaIndex,
    5:     factorize,
    6:     timedelta_range,
    7: )
    8: import pandas._testing as tm
    9: 
   10: 
   11: class TestTimedeltaIndexFactorize:
   12:     def test_factorize(self):
   13:         idx1 = TimedeltaIndex(["1 day", "1 day", "2 day", "2 day", "3 day", "3 day"])
   14: 
   15:         exp_arr = np.array([0, 0, 1, 1, 2, 2], dtype=np.intp)
   16:         exp_idx = TimedeltaIndex(["1 day", "2 day", "3 day"])
   17: 
   18:         arr, idx = idx1.factorize()
   19:         tm.assert_numpy_array_equal(arr, exp_arr)
   20:         tm.assert_index_equal(idx, exp_idx)
   21:         assert idx.freq == exp_idx.freq
   22: 
   23:         arr, idx = idx1.factorize(sort=True)
   24:         tm.assert_numpy_array_equal(arr, exp_arr)
   25:         tm.assert_index_equal(idx, exp_idx)
   26:         assert idx.freq == exp_idx.freq
   27: 
   28:     def test_factorize_preserves_freq(self):
   29:         # GH#38120 freq should be preserved
   30:         idx3 = timedelta_range("1 day", periods=4, freq="s")
   31:         exp_arr = np.array([0, 1, 2, 3], dtype=np.intp)
   32:         arr, idx = idx3.factorize()
   33:         tm.assert_numpy_array_equal(arr, exp_arr)
   34:         tm.assert_index_equal(idx, idx3)
   35:         assert idx.freq == idx3.freq
   36: 
   37:         arr, idx = factorize(idx3)
   38:         tm.assert_numpy_array_equal(arr, exp_arr)
   39:         tm.assert_index_equal(idx, idx3)
   40:         assert idx.freq == idx3.freq
