    1: from pandas import (
    2:     Index,
    3:     NaT,
    4:     date_range,
    5: )
    6: 
    7: 
    8: def test_is_monotonic_with_nat():
    9:     # GH#31437
   10:     # PeriodIndex.is_monotonic_increasing should behave analogously to DatetimeIndex,
   11:     #  in particular never be monotonic when we have NaT
   12:     dti = date_range("2016-01-01", periods=3)
   13:     pi = dti.to_period("D")
   14:     tdi = Index(dti.view("timedelta64[ns]"))
   15: 
   16:     for obj in [pi, pi._engine, dti, dti._engine, tdi, tdi._engine]:
   17:         if isinstance(obj, Index):
   18:             # i.e. not Engines
   19:             assert obj.is_monotonic_increasing
   20:         assert obj.is_monotonic_increasing
   21:         assert not obj.is_monotonic_decreasing
   22:         assert obj.is_unique
   23: 
   24:     dti1 = dti.insert(0, NaT)
   25:     pi1 = dti1.to_period("D")
   26:     tdi1 = Index(dti1.view("timedelta64[ns]"))
   27: 
   28:     for obj in [pi1, pi1._engine, dti1, dti1._engine, tdi1, tdi1._engine]:
   29:         if isinstance(obj, Index):
   30:             # i.e. not Engines
   31:             assert not obj.is_monotonic_increasing
   32:         assert not obj.is_monotonic_increasing
   33:         assert not obj.is_monotonic_decreasing
   34:         assert obj.is_unique
   35: 
   36:     dti2 = dti.insert(3, NaT)
   37:     pi2 = dti2.to_period("h")
   38:     tdi2 = Index(dti2.view("timedelta64[ns]"))
   39: 
   40:     for obj in [pi2, pi2._engine, dti2, dti2._engine, tdi2, tdi2._engine]:
   41:         if isinstance(obj, Index):
   42:             # i.e. not Engines
   43:             assert not obj.is_monotonic_increasing
   44:         assert not obj.is_monotonic_increasing
   45:         assert not obj.is_monotonic_decreasing
   46:         assert obj.is_unique
