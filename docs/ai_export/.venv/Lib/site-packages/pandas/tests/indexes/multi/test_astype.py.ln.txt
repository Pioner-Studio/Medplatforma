    1: import numpy as np
    2: import pytest
    3: 
    4: from pandas.core.dtypes.dtypes import CategoricalDtype
    5: 
    6: import pandas._testing as tm
    7: 
    8: 
    9: def test_astype(idx):
   10:     expected = idx.copy()
   11:     actual = idx.astype("O")
   12:     tm.assert_copy(actual.levels, expected.levels)
   13:     tm.assert_copy(actual.codes, expected.codes)
   14:     assert actual.names == list(expected.names)
   15: 
   16:     with pytest.raises(TypeError, match="^Setting.*dtype.*object"):
   17:         idx.astype(np.dtype(int))
   18: 
   19: 
   20: @pytest.mark.parametrize("ordered", [True, False])
   21: def test_astype_category(idx, ordered):
   22:     # GH 18630
   23:     msg = "> 1 ndim Categorical are not supported at this time"
   24:     with pytest.raises(NotImplementedError, match=msg):
   25:         idx.astype(CategoricalDtype(ordered=ordered))
   26: 
   27:     if ordered is False:
   28:         # dtype='category' defaults to ordered=False, so only test once
   29:         with pytest.raises(NotImplementedError, match=msg):
   30:             idx.astype("category")
