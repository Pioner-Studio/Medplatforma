    1: import numpy as np
    2: 
    3: from pandas import (
    4:     DataFrame,
    5:     Index,
    6:     Timedelta,
    7:     timedelta_range,
    8: )
    9: import pandas._testing as tm
   10: 
   11: 
   12: class TestJoin:
   13:     def test_append_join_nondatetimeindex(self):
   14:         rng = timedelta_range("1 days", periods=10)
   15:         idx = Index(["a", "b", "c", "d"])
   16: 
   17:         result = rng.append(idx)
   18:         assert isinstance(result[0], Timedelta)
   19: 
   20:         # it works
   21:         rng.join(idx, how="outer")
   22: 
   23:     def test_join_self(self, join_type):
   24:         index = timedelta_range("1 day", periods=10)
   25:         joined = index.join(index, how=join_type)
   26:         tm.assert_index_equal(index, joined)
   27: 
   28:     def test_does_not_convert_mixed_integer(self):
   29:         df = DataFrame(np.ones((5, 5)), columns=timedelta_range("1 day", periods=5))
   30: 
   31:         cols = df.columns.join(df.index, how="outer")
   32:         joined = cols.join(df.columns)
   33:         assert cols.dtype == np.dtype("O")
   34:         assert cols.dtype == joined.dtype
   35:         tm.assert_index_equal(cols, joined)
   36: 
   37:     def test_join_preserves_freq(self):
   38:         # GH#32157
   39:         tdi = timedelta_range("1 day", periods=10)
   40:         result = tdi[:5].join(tdi[5:], how="outer")
   41:         assert result.freq == tdi.freq
   42:         tm.assert_index_equal(result, tdi)
   43: 
   44:         result = tdi[:5].join(tdi[6:], how="outer")
   45:         assert result.freq is None
   46:         expected = tdi.delete(5)
   47:         tm.assert_index_equal(result, expected)
