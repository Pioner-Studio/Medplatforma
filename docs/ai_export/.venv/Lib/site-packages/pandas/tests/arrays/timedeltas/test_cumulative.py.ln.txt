    1: import pytest
    2: 
    3: import pandas._testing as tm
    4: from pandas.core.arrays import TimedeltaArray
    5: 
    6: 
    7: class TestAccumulator:
    8:     def test_accumulators_disallowed(self):
    9:         # GH#50297
   10:         arr = TimedeltaArray._from_sequence(["1D", "2D"], dtype="m8[ns]")
   11:         with pytest.raises(TypeError, match="cumprod not supported"):
   12:             arr._accumulate("cumprod")
   13: 
   14:     def test_cumsum(self, unit):
   15:         # GH#50297
   16:         dtype = f"m8[{unit}]"
   17:         arr = TimedeltaArray._from_sequence(["1D", "2D"], dtype=dtype)
   18:         result = arr._accumulate("cumsum")
   19:         expected = TimedeltaArray._from_sequence(["1D", "3D"], dtype=dtype)
   20:         tm.assert_timedelta_array_equal(result, expected)
