    1: import numpy as np
    2: 
    3: from pandas import (
    4:     DataFrame,
    5:     Index,
    6:     MultiIndex,
    7:     Series,
    8:     _testing as tm,
    9: )
   10: 
   11: 
   12: def test_get_dummies(any_string_dtype):
   13:     s = Series(["a|b", "a|c", np.nan], dtype=any_string_dtype)
   14:     result = s.str.get_dummies("|")
   15:     expected = DataFrame([[1, 1, 0], [1, 0, 1], [0, 0, 0]], columns=list("abc"))
   16:     tm.assert_frame_equal(result, expected)
   17: 
   18:     s = Series(["a;b", "a", 7], dtype=any_string_dtype)
   19:     result = s.str.get_dummies(";")
   20:     expected = DataFrame([[0, 1, 1], [0, 1, 0], [1, 0, 0]], columns=list("7ab"))
   21:     tm.assert_frame_equal(result, expected)
   22: 
   23: 
   24: def test_get_dummies_index():
   25:     # GH9980, GH8028
   26:     idx = Index(["a|b", "a|c", "b|c"])
   27:     result = idx.str.get_dummies("|")
   28: 
   29:     expected = MultiIndex.from_tuples(
   30:         [(1, 1, 0), (1, 0, 1), (0, 1, 1)], names=("a", "b", "c")
   31:     )
   32:     tm.assert_index_equal(result, expected)
   33: 
   34: 
   35: def test_get_dummies_with_name_dummy(any_string_dtype):
   36:     # GH 12180
   37:     # Dummies named 'name' should work as expected
   38:     s = Series(["a", "b,name", "b"], dtype=any_string_dtype)
   39:     result = s.str.get_dummies(",")
   40:     expected = DataFrame([[1, 0, 0], [0, 1, 1], [0, 1, 0]], columns=["a", "b", "name"])
   41:     tm.assert_frame_equal(result, expected)
   42: 
   43: 
   44: def test_get_dummies_with_name_dummy_index():
   45:     # GH 12180
   46:     # Dummies named 'name' should work as expected
   47:     idx = Index(["a|b", "name|c", "b|name"])
   48:     result = idx.str.get_dummies("|")
   49: 
   50:     expected = MultiIndex.from_tuples(
   51:         [(1, 1, 0, 0), (0, 0, 1, 1), (0, 1, 0, 1)], names=("a", "b", "c", "name")
   52:     )
   53:     tm.assert_index_equal(result, expected)
