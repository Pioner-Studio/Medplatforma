    1: import pytest
    2: 
    3: from pandas.compat._optional import VERSIONS
    4: 
    5: import pandas as pd
    6: from pandas.core.computation import expr
    7: from pandas.core.computation.engines import ENGINES
    8: from pandas.util.version import Version
    9: 
   10: 
   11: def test_compat():
   12:     # test we have compat with our version of numexpr
   13: 
   14:     from pandas.core.computation.check import NUMEXPR_INSTALLED
   15: 
   16:     ne = pytest.importorskip("numexpr")
   17: 
   18:     ver = ne.__version__
   19:     if Version(ver) < Version(VERSIONS["numexpr"]):
   20:         assert not NUMEXPR_INSTALLED
   21:     else:
   22:         assert NUMEXPR_INSTALLED
   23: 
   24: 
   25: @pytest.mark.parametrize("engine", ENGINES)
   26: @pytest.mark.parametrize("parser", expr.PARSERS)
   27: def test_invalid_numexpr_version(engine, parser):
   28:     if engine == "numexpr":
   29:         pytest.importorskip("numexpr")
   30:     a, b = 1, 2  # noqa: F841
   31:     res = pd.eval("a + b", engine=engine, parser=parser)
   32:     assert res == 3
