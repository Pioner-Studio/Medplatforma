    1: """
    2: Tests for offset behavior with indices.
    3: """
    4: import pytest
    5: 
    6: from pandas import (
    7:     Series,
    8:     date_range,
    9: )
   10: 
   11: from pandas.tseries.offsets import (
   12:     BMonthBegin,
   13:     BMonthEnd,
   14:     BQuarterBegin,
   15:     BQuarterEnd,
   16:     BYearBegin,
   17:     BYearEnd,
   18:     MonthBegin,
   19:     MonthEnd,
   20:     QuarterBegin,
   21:     QuarterEnd,
   22:     YearBegin,
   23:     YearEnd,
   24: )
   25: 
   26: 
   27: @pytest.mark.parametrize("n", [-2, 1])
   28: @pytest.mark.parametrize(
   29:     "cls",
   30:     [
   31:         MonthBegin,
   32:         MonthEnd,
   33:         BMonthBegin,
   34:         BMonthEnd,
   35:         QuarterBegin,
   36:         QuarterEnd,
   37:         BQuarterBegin,
   38:         BQuarterEnd,
   39:         YearBegin,
   40:         YearEnd,
   41:         BYearBegin,
   42:         BYearEnd,
   43:     ],
   44: )
   45: def test_apply_index(cls, n):
   46:     offset = cls(n=n)
   47:     rng = date_range(start="1/1/2000", periods=100000, freq="min")
   48:     ser = Series(rng)
   49: 
   50:     res = rng + offset
   51:     assert res.freq is None  # not retained
   52:     assert res[0] == rng[0] + offset
   53:     assert res[-1] == rng[-1] + offset
   54:     res2 = ser + offset
   55:     # apply_index is only for indexes, not series, so no res2_v2
   56:     assert res2.iloc[0] == ser.iloc[0] + offset
   57:     assert res2.iloc[-1] == ser.iloc[-1] + offset
