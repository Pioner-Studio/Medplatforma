    1: from textwrap import dedent
    2: 
    3: import pytest
    4: 
    5: from pandas import (
    6:     DataFrame,
    7:     Series,
    8: )
    9: 
   10: pytest.importorskip("jinja2")
   11: from pandas.io.formats.style import Styler
   12: 
   13: 
   14: @pytest.fixture
   15: def df():
   16:     return DataFrame(
   17:         {"A": [0, 1], "B": [-0.61, -1.22], "C": Series(["ab", "cd"], dtype=object)}
   18:     )
   19: 
   20: 
   21: @pytest.fixture
   22: def styler(df):
   23:     return Styler(df, uuid_len=0, precision=2)
   24: 
   25: 
   26: def test_basic_string(styler):
   27:     result = styler.to_string()
   28:     expected = dedent(
   29:         """\
   30:      A B C
   31:     0 0 -0.61 ab
   32:     1 1 -1.22 cd
   33:     """
   34:     )
   35:     assert result == expected
   36: 
   37: 
   38: def test_string_delimiter(styler):
   39:     result = styler.to_string(delimiter=";")
   40:     expected = dedent(
   41:         """\
   42:     ;A;B;C
   43:     0;0;-0.61;ab
   44:     1;1;-1.22;cd
   45:     """
   46:     )
   47:     assert result == expected
   48: 
   49: 
   50: def test_concat(styler):
   51:     result = styler.concat(styler.data.agg(["sum"]).style).to_string()
   52:     expected = dedent(
   53:         """\
   54:      A B C
   55:     0 0 -0.61 ab
   56:     1 1 -1.22 cd
   57:     sum 1 -1.830000 abcd
   58:     """
   59:     )
   60:     assert result == expected
   61: 
   62: 
   63: def test_concat_recursion(styler):
   64:     df = styler.data
   65:     styler1 = styler
   66:     styler2 = Styler(df.agg(["sum"]), uuid_len=0, precision=3)
   67:     styler3 = Styler(df.agg(["sum"]), uuid_len=0, precision=4)
   68:     result = styler1.concat(styler2.concat(styler3)).to_string()
   69:     expected = dedent(
   70:         """\
   71:      A B C
   72:     0 0 -0.61 ab
   73:     1 1 -1.22 cd
   74:     sum 1 -1.830 abcd
   75:     sum 1 -1.8300 abcd
   76:     """
   77:     )
   78:     assert result == expected
   79: 
   80: 
   81: def test_concat_chain(styler):
   82:     df = styler.data
   83:     styler1 = styler
   84:     styler2 = Styler(df.agg(["sum"]), uuid_len=0, precision=3)
   85:     styler3 = Styler(df.agg(["sum"]), uuid_len=0, precision=4)
   86:     result = styler1.concat(styler2).concat(styler3).to_string()
   87:     expected = dedent(
   88:         """\
   89:      A B C
   90:     0 0 -0.61 ab
   91:     1 1 -1.22 cd
   92:     sum 1 -1.830 abcd
   93:     sum 1 -1.8300 abcd
   94:     """
   95:     )
   96:     assert result == expected
