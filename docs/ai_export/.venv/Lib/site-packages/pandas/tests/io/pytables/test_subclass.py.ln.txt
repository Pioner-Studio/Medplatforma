    1: import numpy as np
    2: import pytest
    3: 
    4: from pandas import (
    5:     DataFrame,
    6:     Series,
    7: )
    8: import pandas._testing as tm
    9: 
   10: from pandas.io.pytables import (
   11:     HDFStore,
   12:     read_hdf,
   13: )
   14: 
   15: pytest.importorskip("tables")
   16: 
   17: 
   18: class TestHDFStoreSubclass:
   19:     # GH 33748
   20:     def test_supported_for_subclass_dataframe(self, tmp_path):
   21:         data = {"a": [1, 2], "b": [3, 4]}
   22:         sdf = tm.SubclassedDataFrame(data, dtype=np.intp)
   23: 
   24:         expected = DataFrame(data, dtype=np.intp)
   25: 
   26:         path = tmp_path / "temp.h5"
   27:         sdf.to_hdf(path, key="df")
   28:         result = read_hdf(path, "df")
   29:         tm.assert_frame_equal(result, expected)
   30: 
   31:         path = tmp_path / "temp.h5"
   32:         with HDFStore(path) as store:
   33:             store.put("df", sdf)
   34:         result = read_hdf(path, "df")
   35:         tm.assert_frame_equal(result, expected)
   36: 
   37:     def test_supported_for_subclass_series(self, tmp_path):
   38:         data = [1, 2, 3]
   39:         sser = tm.SubclassedSeries(data, dtype=np.intp)
   40: 
   41:         expected = Series(data, dtype=np.intp)
   42: 
   43:         path = tmp_path / "temp.h5"
   44:         sser.to_hdf(path, key="ser")
   45:         result = read_hdf(path, "ser")
   46:         tm.assert_series_equal(result, expected)
   47: 
   48:         path = tmp_path / "temp.h5"
   49:         with HDFStore(path) as store:
   50:             store.put("ser", sser)
   51:         result = read_hdf(path, "ser")
   52:         tm.assert_series_equal(result, expected)
