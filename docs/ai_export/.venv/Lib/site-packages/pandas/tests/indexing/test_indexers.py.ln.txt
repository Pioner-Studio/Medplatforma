    1: # Tests aimed at pandas.core.indexers
    2: import numpy as np
    3: import pytest
    4: 
    5: from pandas.core.indexers import (
    6:     is_scalar_indexer,
    7:     length_of_indexer,
    8:     validate_indices,
    9: )
   10: 
   11: 
   12: def test_length_of_indexer():
   13:     arr = np.zeros(4, dtype=bool)
   14:     arr[0] = 1
   15:     result = length_of_indexer(arr)
   16:     assert result == 1
   17: 
   18: 
   19: def test_is_scalar_indexer():
   20:     indexer = (0, 1)
   21:     assert is_scalar_indexer(indexer, 2)
   22:     assert not is_scalar_indexer(indexer[0], 2)
   23: 
   24:     indexer = (np.array([2]), 1)
   25:     assert not is_scalar_indexer(indexer, 2)
   26: 
   27:     indexer = (np.array([2]), np.array([3]))
   28:     assert not is_scalar_indexer(indexer, 2)
   29: 
   30:     indexer = (np.array([2]), np.array([3, 4]))
   31:     assert not is_scalar_indexer(indexer, 2)
   32: 
   33:     assert not is_scalar_indexer(slice(None), 1)
   34: 
   35:     indexer = 0
   36:     assert is_scalar_indexer(indexer, 1)
   37: 
   38:     indexer = (0,)
   39:     assert is_scalar_indexer(indexer, 1)
   40: 
   41: 
   42: class TestValidateIndices:
   43:     def test_validate_indices_ok(self):
   44:         indices = np.asarray([0, 1])
   45:         validate_indices(indices, 2)
   46:         validate_indices(indices[:0], 0)
   47:         validate_indices(np.array([-1, -1]), 0)
   48: 
   49:     def test_validate_indices_low(self):
   50:         indices = np.asarray([0, -2])
   51:         with pytest.raises(ValueError, match="'indices' contains"):
   52:             validate_indices(indices, 2)
   53: 
   54:     def test_validate_indices_high(self):
   55:         indices = np.asarray([0, 1, 2])
   56:         with pytest.raises(IndexError, match="indices are out"):
   57:             validate_indices(indices, 2)
   58: 
   59:     def test_validate_indices_empty(self):
   60:         with pytest.raises(IndexError, match="indices are out"):
   61:             validate_indices(np.array([0, 1]), 0)
