    1: import pytest
    2: 
    3: import pandas as pd
    4: 
    5: 
    6: class TestFlags:
    7:     def test_equality(self):
    8:         a = pd.DataFrame().set_flags(allows_duplicate_labels=True).flags
    9:         b = pd.DataFrame().set_flags(allows_duplicate_labels=False).flags
   10: 
   11:         assert a == a
   12:         assert b == b
   13:         assert a != b
   14:         assert a != 2
   15: 
   16:     def test_set(self):
   17:         df = pd.DataFrame().set_flags(allows_duplicate_labels=True)
   18:         a = df.flags
   19:         a.allows_duplicate_labels = False
   20:         assert a.allows_duplicate_labels is False
   21:         a["allows_duplicate_labels"] = True
   22:         assert a.allows_duplicate_labels is True
   23: 
   24:     def test_repr(self):
   25:         a = repr(pd.DataFrame({"A"}).set_flags(allows_duplicate_labels=True).flags)
   26:         assert a == "<Flags(allows_duplicate_labels=True)>"
   27:         a = repr(pd.DataFrame({"A"}).set_flags(allows_duplicate_labels=False).flags)
   28:         assert a == "<Flags(allows_duplicate_labels=False)>"
   29: 
   30:     def test_obj_ref(self):
   31:         df = pd.DataFrame()
   32:         flags = df.flags
   33:         del df
   34:         with pytest.raises(ValueError, match="object has been deleted"):
   35:             flags.allows_duplicate_labels = True
   36: 
   37:     def test_getitem(self):
   38:         df = pd.DataFrame()
   39:         flags = df.flags
   40:         assert flags["allows_duplicate_labels"] is True
   41:         flags["allows_duplicate_labels"] = False
   42:         assert flags["allows_duplicate_labels"] is False
   43: 
   44:         with pytest.raises(KeyError, match="a"):
   45:             flags["a"]
   46: 
   47:         with pytest.raises(ValueError, match="a"):
   48:             flags["a"] = 10
