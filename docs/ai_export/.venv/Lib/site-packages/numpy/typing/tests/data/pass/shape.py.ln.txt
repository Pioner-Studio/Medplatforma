    1: from typing import Any, NamedTuple, cast
    2: 
    3: import numpy as np
    4: 
    5: 
    6: # Subtype of tuple[int, int]
    7: class XYGrid(NamedTuple):
    8:     x_axis: int
    9:     y_axis: int
   10: 
   11: # Test variance of _ShapeT_co
   12: def accepts_2d(a: np.ndarray[tuple[int, int], Any]) -> None:
   13:     return None
   14: 
   15: 
   16: accepts_2d(np.empty(XYGrid(2, 2)))
   17: accepts_2d(np.zeros(XYGrid(2, 2), dtype=int))
   18: accepts_2d(np.ones(XYGrid(2, 2), dtype=int))
   19: accepts_2d(np.full(XYGrid(2, 2), fill_value=5, dtype=int))
