    1: import textwrap
    2: 
    3: import pytest
    4: 
    5: from numpy.testing import IS_PYPY
    6: 
    7: from . import util
    8: 
    9: 
   10: class TestMixed(util.F2PyTest):
   11:     sources = [
   12:         util.getpath("tests", "src", "mixed", "foo.f"),
   13:         util.getpath("tests", "src", "mixed", "foo_fixed.f90"),
   14:         util.getpath("tests", "src", "mixed", "foo_free.f90"),
   15:     ]
   16: 
   17:     @pytest.mark.slow
   18:     def test_all(self):
   19:         assert self.module.bar11() == 11
   20:         assert self.module.foo_fixed.bar12() == 12
   21:         assert self.module.foo_free.bar13() == 13
   22: 
   23:     @pytest.mark.xfail(IS_PYPY,
   24:                        reason="PyPy cannot modify tp_doc after PyType_Ready")
   25:     def test_docstring(self):
   26:         expected = textwrap.dedent("""\
   27:         a = bar11()
   28: 
   29:         Wrapper for ``bar11``.
   30: 
   31:         Returns
   32:         -------
   33:         a : int
   34:         """)
   35:         assert self.module.bar11.__doc__ == expected
