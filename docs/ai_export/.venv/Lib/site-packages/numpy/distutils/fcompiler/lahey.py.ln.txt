    1: import os
    2: 
    3: from numpy.distutils.fcompiler import FCompiler
    4: 
    5: compilers = ['LaheyFCompiler']
    6: 
    7: class LaheyFCompiler(FCompiler):
    8: 
    9:     compiler_type = 'lahey'
   10:     description = 'Lahey/Fujitsu Fortran 95 Compiler'
   11:     version_pattern =  r'Lahey/Fujitsu Fortran 95 Compiler Release (?P<version>[^\s*]*)'
   12: 
   13:     executables = {
   14:         'version_cmd'  : ["<F90>", "--version"],
   15:         'compiler_f77' : ["lf95", "--fix"],
   16:         'compiler_fix' : ["lf95", "--fix"],
   17:         'compiler_f90' : ["lf95"],
   18:         'linker_so'    : ["lf95", "-shared"],
   19:         'archiver'     : ["ar", "-cr"],
   20:         'ranlib'       : ["ranlib"]
   21:         }
   22: 
   23:     module_dir_switch = None  #XXX Fix me
   24:     module_include_switch = None #XXX Fix me
   25: 
   26:     def get_flags_opt(self):
   27:         return ['-O']
   28:     def get_flags_debug(self):
   29:         return ['-g', '--chk', '--chkglobal']
   30:     def get_library_dirs(self):
   31:         opt = []
   32:         d = os.environ.get('LAHEY')
   33:         if d:
   34:             opt.append(os.path.join(d, 'lib'))
   35:         return opt
   36:     def get_libraries(self):
   37:         opt = []
   38:         opt.extend(['fj9f6', 'fj9i6', 'fj9ipp', 'fj9e6'])
   39:         return opt
   40: 
   41: if __name__ == '__main__':
   42:     from distutils import log
   43:     log.set_verbosity(2)
   44:     from numpy.distutils import customized_fcompiler
   45:     print(customized_fcompiler(compiler='lahey').get_version())
