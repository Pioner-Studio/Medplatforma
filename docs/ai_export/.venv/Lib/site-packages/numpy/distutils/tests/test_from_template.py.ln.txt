    1: 
    2: from numpy.distutils.from_template import process_str
    3: from numpy.testing import assert_equal
    4: 
    5: 
    6: pyf_src = """
    7: python module foo
    8:     <_rd=real,double precision>
    9:     interface
   10:         subroutine <s,d>foosub(tol)
   11:             <_rd>, intent(in,out) :: tol
   12:         end subroutine <s,d>foosub
   13:     end interface
   14: end python module foo
   15: """
   16: 
   17: expected_pyf = """
   18: python module foo
   19:     interface
   20:         subroutine sfoosub(tol)
   21:             real, intent(in,out) :: tol
   22:         end subroutine sfoosub
   23:         subroutine dfoosub(tol)
   24:             double precision, intent(in,out) :: tol
   25:         end subroutine dfoosub
   26:     end interface
   27: end python module foo
   28: """
   29: 
   30: 
   31: def normalize_whitespace(s):
   32:     """
   33:     Remove leading and trailing whitespace, and convert internal
   34:     stretches of whitespace to a single space.
   35:     """
   36:     return ' '.join(s.split())
   37: 
   38: 
   39: def test_from_template():
   40:     """Regression test for gh-10712."""
   41:     pyf = process_str(pyf_src)
   42:     normalized_pyf = normalize_whitespace(pyf)
   43:     normalized_expected_pyf = normalize_whitespace(expected_pyf)
   44:     assert_equal(normalized_pyf, normalized_expected_pyf)
