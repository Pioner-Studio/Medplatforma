    1: import os
    2: import sys
    3: if 'setuptools' in sys.modules:
    4:     from setuptools.command.bdist_rpm import bdist_rpm as old_bdist_rpm
    5: else:
    6:     from distutils.command.bdist_rpm import bdist_rpm as old_bdist_rpm
    7: 
    8: class bdist_rpm(old_bdist_rpm):
    9: 
   10:     def _make_spec_file(self):
   11:         spec_file = old_bdist_rpm._make_spec_file(self)
   12: 
   13:         # Replace hardcoded setup.py script name
   14:         # with the real setup script name.
   15:         setup_py = os.path.basename(sys.argv[0])
   16:         if setup_py == 'setup.py':
   17:             return spec_file
   18:         new_spec_file = []
   19:         for line in spec_file:
   20:             line = line.replace('setup.py', setup_py)
   21:             new_spec_file.append(line)
   22:         return new_spec_file
