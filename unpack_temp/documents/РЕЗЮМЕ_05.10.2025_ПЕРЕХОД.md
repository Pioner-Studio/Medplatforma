# –†–ï–ó–Æ–ú–ï –°–ï–°–°–ò–ò 05.10.2025 - –ü–ï–†–ï–•–û–î –í –ù–û–í–´–ô –ß–ê–¢

## ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û –ó–ê 5+ –ß–ê–°–û–í

### –ë–õ–û–ö 1: –†–û–õ–ò –ò –î–û–°–¢–£–ü–´ - 100% ‚úÖ
**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- –°–æ–∑–¥–∞–Ω–∞ —Ä–æ–ª—å "owner" –¥–ª—è —Ç—Ä–æ–∏—Ö (–ì–æ–≥—É–µ–≤–∞, –ù–∞–∫–æ–Ω–µ—á–Ω–∞—è, –ù–∞–∫–æ–Ω–µ—á–Ω—ã–π)
- –£–¥–∞–ª–µ–Ω–∞ –ú–∏—Ä–≥–∞—Ç–∏—è –û.–°. –∏–∑ –ë–î
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è:
  - "–∫–∞—Ä—Ç–æ—á–∫–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞" ‚Üí "–∫–∞—Ä—Ç–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞" (9 —Ñ–∞–π–ª–æ–≤)
  - "–±–æ–Ω—É—Å—ã" ‚Üí "–±–∞–ª–ª—ã –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã" (3 —Ñ–∞–π–ª–∞)
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π:
  - production_auth.py - admin_required –≤–∫–ª—é—á–∞–µ—Ç owner
  - routes_finance.py - –≤—Å–µ @role_required –æ–±–Ω–æ–≤–ª–µ–Ω—ã
  - main.py - 5 –º–µ—Å—Ç —Å chief_doctor ‚Üí owner
- UI –æ–±–Ω–æ–≤–ª—ë–Ω:
  - topbar.html - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç "–í–ª–∞–¥–µ–ª–µ—Ü"
  - sidebar.html - –¥–æ—Å—Ç—É–ø –¥–ª—è owner

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:** 
- production_auth.py, routes_finance.py, main.py
- templates: topbar.html, sidebar.html, patient_card.html, add.html, add_patient.html, 
  treatment_plan_new.html, patients.html, list.html, treatment_plan_edit.html, 
  debtors.html, patient_questionnaire.html

---

### –ë–õ–û–ö 2: –°–ò–°–¢–ï–ú–ê –°–¢–ê–¢–£–°–û–í –ò –î–û–õ–ì–û–í - 85% ‚úÖ

**2.1 –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ–ª–≥–∞ –æ—Ç–∫–ª—é—á–µ–Ω–æ ‚úÖ**
- –§–∞–π–ª: main.py, —Å—Ç—Ä–æ–∫–∏ 1841-1961
- –ë–ª–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è ledger –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- –î–æ–ª–≥ —Ç–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–∏–µ–º–∞

**2.2 –°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π –≤ –ë–î ‚úÖ**
- –ú–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞: 6 –∑–∞–ø–∏—Å–µ–π –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è: status, visit_comment, visit_number, total_visits, 
  related_appointment_id, completed_at, completed_by, cancellation_reason, 
  cancelled_by, cancelled_at, original_appointment_id, rescheduled_to
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞–º: no_show_count

**2.3 –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ ‚úÖ**
- –§–∞–π–ª: templates/calendar.html
- 2 –Ω–æ–≤—ã—Ö –º–æ–¥–∞–ª–∞: statusModal, completeModal
- eventClick –æ–±–Ω–æ–≤–ª—ë–Ω - –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç statusModal
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º:
  - scheduled ‚Üí —Å–∏–Ω–∏–π (#0d6efd)
  - arrived ‚Üí –∑–µ–ª—ë–Ω—ã–π (#198754)
  - completed ‚Üí —Å–µ—Ä—ã–π (#6c757d)
  - cancelled ‚Üí –∫—Ä–∞—Å–Ω—ã–π (#dc3545)
  - no_show ‚Üí –æ—Ä–∞–Ω–∂–µ–≤—ã–π (#fd7e14)

**2.4 API —Ä–æ—É—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞–º–∏ ‚úÖ**
- POST /appointments/<id>/arrive - –æ—Ç–º–µ—Ç–∏—Ç—å –ø—Ä–∏—Ö–æ–¥
- POST /appointments/<id>/no-show - –Ω–µ —è–≤–∏–ª—Å—è (+ —Å—á–µ—Ç—á–∏–∫)
- POST /appointments/<id>/cancel - –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å
- POST /appointments/<id>/reschedule - –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏
- POST /appointments/<id>/complete - –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–∏—ë–º —Å –∞–≤—Ç–æ–¥–æ–ª–≥–æ–º

**2.5 –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–∏—ë–º–∞ ‚úÖ**
- –§–∞–π–ª: main.py, —Ñ—É–Ω–∫—Ü–∏—è appointment_complete() (—Å—Ç—Ä–æ–∫–∞ ~5914)
- –õ–æ–≥–∏–∫–∞:
  1. –ü–æ–ª—É—á–∏—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞, —É—Å–ª—É–≥—É, —Ü–µ–Ω—É (–ª—å–≥–æ—Ç–Ω—É—é –∏–ª–∏ –æ–±—ã—á–Ω—É—é)
  2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–ø–æ–∑–∏—Ç
  3. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–æ–ª–≥: –µ—Å–ª–∏ –¥–µ–ø–æ–∑–∏—Ç >= —Ü–µ–Ω–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–ø–æ–∑–∏—Ç, –∏–Ω–∞—á–µ —Å–æ–∑–¥–∞—Ç—å –¥–æ–ª–≥
  4. –û–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞ (deposit_balance, debt_balance)
  5. –°–æ–∑–¥–∞—Ç—å ledger (kind="service_completed")
  6. –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –≤ debts (–¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ–ª–≥)
  7. –û–±–Ω–æ–≤–∏—Ç—å appointments (status, completed_at, visit_comment)
  8. –ï—Å–ª–∏ –∏–∑ –ø–ª–∞–Ω–∞ ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å —É—Å–ª—É–≥–∏ –≤ –ø–ª–∞–Ω–µ
  9. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**API –æ–±–Ω–æ–≤–ª—ë–Ω –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ ‚úÖ**
- /api/events —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
  - status –∏–∑ –∑–∞–ø–∏—Å–∏ (a.get("status"))
  - patient_name, doctor_name, service_name

---

### –î–ï–¢–ê–õ–ò–ó–ê–¶–ò–Ø –î–û–õ–ì–û–í - 100% ‚úÖ

**–ö–æ–ª–ª–µ–∫—Ü–∏—è debts —Å–æ–∑–¥–∞–Ω–∞ ‚úÖ**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
```javascript
  {
    patient_id: ObjectId,
    appointment_id: ObjectId,
    service_name: "–ì–∏–≥–∏–µ–Ω–∞ –ø–æ–ª–æ—Å—Ç–∏ —Ä—Ç–∞ –≤–∑—Ä",
    total_amount: 13000,
    paid_amount: 0,
    debt_amount: 13000,
    created_at: DateTime,
    status: "unpaid" | "paid",
    ledger_id: ObjectId
  }

–ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã: patient_id, appointment_id, created_at
–ú–∏–≥—Ä–∞—Ü–∏—è: 2 –∑–∞–ø–∏—Å–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –∏–∑ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã

API –¥–æ–ª–≥–æ–≤ ‚úÖ

GET /api/patients/<id>/debts
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ–ª–≥–æ–≤ —Å –¥–µ—Ç–∞–ª—è–º–∏

UI –≤ –∫–∞—Ä—Ç–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞ ‚úÖ

–§–∞–π–ª: templates/patient_card.html
–î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–æ–ª–≥–æ–≤:

–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏
–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (üìÖ 05.10.2025)
–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏
–û–ø–ª–∞—á–µ–Ω–æ
–ù–µ–¥–æ–ø–ª–∞—Ç–∞ (–∫—Ä–∞—Å–Ω—ã–º)
–°—Ç–∞—Ç—É—Å (–±–µ–π–¥–∂)
–ö–Ω–æ–ø–∫–∞ "–û–ø–ª–∞—Ç–∏—Ç—å" (–¥–ª—è –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö)


JavaScript –∑–∞–≥—Ä—É–∂–∞–µ—Ç —á–µ—Ä–µ–∑ API


‚è≥ –û–°–¢–ê–õ–û–°–¨ –ò–ó –ë–õ–û–ö–ê 2
2.6 –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (2-3 —á–∞—Å–∞)

–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤—Ä–∞—á–∞
–ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
–ù—É–º–µ—Ä–∞—Ü–∏—è –≤–∏–∑–∏—Ç–æ–≤ (visit_number++)

2.7-2.10 –ò—Å—Ç–æ—Ä–∏—è –ª–µ—á–µ–Ω–∏—è (2-3 —á–∞—Å–∞)

–¶–µ–ø–æ—á–∫–∞ –≤–∏–∑–∏—Ç–æ–≤ (–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ related_appointment_id)
–ü–æ–∫–∞–∑ –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–∏ —Å —Å—Ç–∞—Ç—É—Å–∞–º–∏
–õ–æ–≥–∏–∫–∞ No-Show (–Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É)
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –≤–∏–∑–∏—Ç–∞–º


üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò
MongoDB Atlas:

–ë–∞–∑–∞: medplatforma
–ö–æ–ª–ª–µ–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: appointments, patients, debts (–Ω–æ–≤–∞—è)

–í–∞–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

appointment_complete() - —Å—Ç—Ä–æ–∫–∞ ~5914 –≤ main.py
api_patient_debts() - –Ω–æ–≤—ã–π —Ä–æ—É—Ç
loadDebtsDetails() - JavaScript –≤ patient_card.html

–°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π:

scheduled, arrived, completed, cancelled, no_show, rescheduled

–¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è:

–°–∏–Ω–∏–π = –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
–ó–µ–ª—ë–Ω—ã–π = –ø—Ä–∏—à—ë–ª
–°–µ—Ä—ã–π = –∑–∞–≤–µ—Ä—à–µ–Ω–æ
–ö—Ä–∞—Å–Ω—ã–π = –æ—Ç–º–µ–Ω–µ–Ω–æ
–û—Ä–∞–Ω–∂–µ–≤—ã–π = –Ω–µ —è–≤–∏–ª—Å—è


üìã –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–¥–ª—è –Ω–æ–≤–æ–≥–æ —á–∞—Ç–∞)
–ü–†–ò–û–†–ò–¢–ï–¢ 1: –î–æ—Ä–∞–±–æ—Ç–∫–∞ –ë–õ–û–ö–ê 2

–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–ø–æ—á–∫–∏ –≤–∏–∑–∏—Ç–æ–≤
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–∞—Ç—É—Å–æ–≤

–ü–†–ò–û–†–ò–¢–ï–¢ 2: –ë–õ–û–ö 3 - –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ (–±–∞–ª–ª—ã)

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å bonus ‚Üí points
2 —É—Ä–æ–≤–Ω—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è (10% + 3%)
–°–ø–∏—Å–∞–Ω–∏–µ –±–∞–ª–ª–æ–≤ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ
UI –≤ –∫–∞—Ä—Ç–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞

–ü–†–ò–û–†–ò–¢–ï–¢ 3: –ë–õ–û–ö 4 - –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤—Ä–∞—á–µ–π

–ù–µ–¥–µ–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Å—è—Ü–µ–≤
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∑–∞–ø–∏—Å—è–º–∏


üêõ –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

–ö–Ω–æ–ø–∫–∞ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –≤ statusModal –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ—Ç API —Ä–æ—É—Ç–∞)
DeprecationWarning: datetime.utcnow() (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
–§—É–Ω–∫—Ü–∏–∏ viewDetails() –∏ repeatAppointment() - –∑–∞–≥–ª—É—à–∫–∏


üöÄ –ö–û–ú–ê–ù–î–ê –î–õ–Ø –ù–û–í–û–ì–û –ß–ê–¢–ê
–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –º–µ–¥–ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

–¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï:
- –ë–ª–æ–∫ 1 (–†–æ–ª–∏) - 100% ‚úÖ
- –ë–ª–æ–∫ 2 (–°—Ç–∞—Ç—É—Å—ã –∏ –¥–æ–ª–≥–∏) - 85% ‚úÖ
- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ª–≥–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

–°–õ–ï–î–£–Æ–©–ê–Ø –ó–ê–î–ê–ß–ê: –ë–ª–æ–∫ 2.6 - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø–∏—Å–∏
- –§–æ—Ä–º–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–∏—ë–º–∞
- –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤—Ä–∞—á–∞
- –ù—É–º–µ—Ä–∞—Ü–∏—è –≤–∏–∑–∏—Ç–æ–≤

–§–ê–ô–õ–´ –î–õ–Ø –†–ê–ë–û–¢–´:
- main.py (appointment_complete –Ω–∞ —Å—Ç—Ä–æ–∫–µ ~5914)
- templates/calendar.html (–º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞)
- templates/patient_card.html (–∏—Å—Ç–æ—Ä–∏—è –≤–∏–∑–∏—Ç–æ–≤)

–ì–æ—Ç–æ–≤ –Ω–∞—á–∏–Ω–∞—Ç—å —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π?

‚úÖ –†–ï–ó–Æ–ú–ï –°–û–•–†–ê–ù–ï–ù–û
–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–π —á–∞—Ç –í –¢–û–ú –ñ–ï –ü–†–û–ï–ö–¢–ï –∏ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤—ã—à–µ!
